# 光伏快速关断器实验数据管理系统 - 产品需求文档 (PRD)

## 1. 项目概述

### 1.1 产品愿景
开发一款业界领先的光伏快速关断器(PVRSD)实验数据管理系统，提供高端、现代化的工业级数据管理和可视化解决方案，用于支持光伏快速关断器的全生命周期测试、数据分析和合规性验证。

### 1.2 核心价值
- **工业4.0数字化**：将传统的光伏关断器测试流程数字化、智能化
- **数据驱动决策**：通过实时数据可视化和分析，提升测试效率和准确性
- **合规性保障**：符合IEC 62109、UL 1741等国际标准的测试要求
- **智能化管理**：自动化数据采集、分析和报告生成

### 1.3 技术架构
- **前端框架**: Next.js 14 (App Router)
- **UI设计**: Tailwind CSS + Shadcn/ui
- **数据可视化**: Recharts + D3.js
- **后端服务**: Supabase (PostgreSQL + Realtime + Storage)
- **部署平台**: Netlify
- **状态管理**: Zustand
- **表格处理**: React-Table + Excel.js

## 2. 用户角色定义

### 2.1 测试工程师
- 执行各类实验测试
- 查看实时数据
- 生成测试报告
- 管理测试设备

### 2.2 数据分析师
- 分析历史数据
- 创建数据报表
- 导出数据文件
- 趋势分析

### 2.3 质量管理员
- 审核测试结果
- 管理合规性文档
- 设置测试标准
- 生成认证报告

### 2.4 系统管理员
- 用户权限管理
- 系统配置
- 数据备份
- 审计日志

## 3. 功能需求

### 3.1 数据大屏展示
#### 3.1.1 实时监控大屏
- **设备状态概览**: 显示所有测试设备的实时状态（运行中/空闲/故障）
- **关键指标展示**: 
  - 今日测试数量
  - 合格率统计
  - 平均测试时长
  - 设备利用率
- **实时数据流**: 展示正在进行的测试的实时数据曲线
- **告警信息**: 异常数据实时告警提示
- **3D设备模型**: 展示光伏关断器的3D模型和关键参数

#### 3.1.2 数据分析大屏
- **趋势分析图表**: 多维度数据趋势分析
- **对比分析**: 不同批次、不同型号的对比分析
- **热力图**: 故障分布热力图
- **统计报表**: 月度/季度/年度统计报表

### 3.2 高压试验页面
#### 3.2.1 测试参数设置
- **电压等级**: 600V/1000V/1500V DC
- **测试时长**: 1min/5min/60min
- **升压速率**: 100V/s - 500V/s可调
- **测试标准**: IEC 62109-1/UL 1741 SA

#### 3.2.2 实时数据显示
- **电压曲线**: 实时电压变化曲线
- **泄漏电流**: 实时泄漏电流监测
- **绝缘电阻**: 动态绝缘电阻计算
- **温度监测**: 设备温度实时监测

#### 3.2.3 数据记录
- **自动记录**: 每秒采样，自动保存
- **异常标记**: 自动标记异常数据点
- **测试报告**: 自动生成测试报告

### 3.3 泄漏电流实验页面
#### 3.3.1 测试配置
- **测试电压**: 直流工作电压的110%
- **测试环境**: 温度、湿度记录
- **测试回路**: 多通道同时测试
- **精度要求**: 0.1μA分辨率

#### 3.3.2 数据展示
- **电流趋势图**: 多通道泄漏电流趋势
- **统计分析**: 最大值、最小值、平均值、标准差
- **FFT分析**: 频谱分析（针对AC泄漏）
- **温度补偿**: 温度补偿后的标准化数据

### 3.4 正常工况实验页面
#### 3.4.1 工况参数
- **输入功率**: 0-1500W可调
- **环境温度**: -40°C至+85°C
- **输入电压**: 150-1500V DC
- **负载条件**: 阻性/感性/容性负载

#### 3.4.2 性能监测
- **转换效率**: 实时效率曲线
- **功率因数**: PF监测
- **谐波分析**: THD分析
- **热成像**: 温度分布图

### 3.5 非正常工况实验页面
#### 3.5.1 故障模拟
- **过压测试**: 150%额定电压
- **过流测试**: 200%额定电流
- **短路测试**: 输出短路保护
- **反接测试**: 极性反接保护

#### 3.5.2 保护功能验证
- **响应时间**: 保护动作时间测量
- **恢复特性**: 故障清除后恢复测试
- **寿命测试**: 反复动作寿命测试
- **极限测试**: 破坏性测试（可选）

### 3.6 实验仿真页面
#### 3.6.1 仿真模型
- **电路仿真**: SPICE模型仿真
- **热仿真**: 3D热分布仿真
- **机械应力**: 应力分布分析
- **电磁兼容**: EMC仿真

#### 3.6.2 仿真参数
- **参数扫描**: 多参数自动扫描
- **蒙特卡洛**: 统计分析
- **优化算法**: 参数优化
- **对比验证**: 仿真与实测对比

### 3.7 数据文件管理
#### 3.7.1 文件操作
- **上传下载**: 支持Excel、CSV、JSON格式
- **批量处理**: 批量导入导出
- **版本控制**: 文件版本管理
- **数据校验**: 自动数据完整性校验

#### 3.7.2 数据处理
- **数据清洗**: 异常值处理
- **数据转换**: 格式转换工具
- **数据合并**: 多文件数据合并
- **数据分析**: 内置分析工具

## 4. 非功能需求

### 4.1 性能要求
- **响应时间**: 页面加载 < 2秒
- **数据刷新**: 实时数据刷新率 ≥ 10Hz
- **并发用户**: 支持100+并发用户
- **数据容量**: 支持TB级数据存储

### 4.2 安全要求
- **数据加密**: AES-256加密
- **访问控制**: RBAC权限管理
- **审计日志**: 完整操作日志
- **数据备份**: 自动备份机制

### 4.3 可用性要求
- **系统可用性**: 99.9%
- **数据完整性**: 100%
- **灾难恢复**: RPO < 1小时
- **用户体验**: 响应式设计，支持移动端

### 4.4 兼容性要求
- **浏览器支持**: Chrome、Firefox、Safari、Edge最新版本
- **设备兼容**: PC、平板、大屏展示
- **数据格式**: 兼容主流测试设备数据格式
- **标准符合**: IEC、UL、GB等标准

## 5. 数据模型设计

### 5.1 核心数据表
```sql
-- 设备信息表
devices (
  id: uuid
  device_code: string
  device_type: string
  manufacturer: string
  model: string
  serial_number: string
  calibration_date: date
  status: enum
)

-- 实验记录表
experiments (
  id: uuid
  experiment_type: enum
  device_id: uuid
  start_time: timestamp
  end_time: timestamp
  operator_id: uuid
  status: enum
  result: enum
)

-- 测试数据表
test_data (
  id: uuid
  experiment_id: uuid
  timestamp: timestamp
  voltage: float
  current: float
  power: float
  temperature: float
  humidity: float
  additional_data: jsonb
)

-- 测试标准表
test_standards (
  id: uuid
  standard_name: string
  standard_code: string
  parameters: jsonb
  limits: jsonb
)
```

### 5.2 数据关系
- 一个设备可以有多次实验记录
- 一次实验包含多个测试数据点
- 测试标准与实验类型关联

## 6. UI/UX设计原则

### 6.1 设计风格
- **工业美学**: 深色主题，科技感强
- **数据优先**: 突出数据可视化
- **操作简洁**: 最少点击原则
- **反馈及时**: 实时状态反馈

### 6.2 颜色方案
- **主色调**: 深蓝色 (#1a1d29)
- **强调色**: 青色 (#00d4ff)
- **成功色**: 绿色 (#00ff88)
- **警告色**: 橙色 (#ff9500)
- **危险色**: 红色 (#ff3b30)

### 6.3 布局原则
- **响应式布局**: 自适应不同屏幕
- **模块化设计**: 可配置的仪表板
- **信息层次**: 清晰的视觉层次
- **操作区域**: 固定的操作区域

## 7. 开发计划

### 7.1 第一阶段（MVP）- 4周
- 基础框架搭建
- 用户认证系统
- 数据大屏基础版
- 高压试验页面
- 基础数据管理

### 7.2 第二阶段 - 6周
- 泄漏电流实验页面
- 正常工况实验页面
- 数据分析功能
- 报告生成系统

### 7.3 第三阶段 - 6周
- 非正常工况实验页面
- 实验仿真页面
- 高级数据分析
- 系统优化

### 7.4 第四阶段 - 4周
- 移动端适配
- 性能优化
- 安全加固
- 用户培训

## 8. 成功指标

### 8.1 技术指标
- 系统响应时间 < 2秒
- 数据准确率 > 99.99%
- 系统可用性 > 99.9%
- 并发用户数 > 100

### 8.2 业务指标
- 测试效率提升 > 50%
- 数据分析时间减少 > 70%
- 报告生成时间减少 > 80%
- 用户满意度 > 90%

## 9. 风险管理

### 9.1 技术风险
- **数据安全**: 采用多重加密和备份
- **性能瓶颈**: 采用缓存和优化策略
- **系统稳定性**: 完善的错误处理和恢复机制

### 9.2 业务风险
- **需求变更**: 采用敏捷开发方法
- **用户接受度**: 提供完善的培训和文档
- **合规性**: 持续跟踪标准更新

## 10. 附录

### 10.1 术语表
- PVRSD: Photovoltaic Rapid Shutdown Device（光伏快速关断器）
- THD: Total Harmonic Distortion（总谐波失真）
- FFT: Fast Fourier Transform（快速傅里叶变换）
- RBAC: Role-Based Access Control（基于角色的访问控制）

### 10.2 参考标准
- IEC 62109-1: Safety of power converters for use in photovoltaic power systems
- UL 1741: Standard for Inverters, Converters, Controllers and Interconnection System Equipment
- GB/T 37408: Technical requirements for rapid shutdown device of photovoltaic system

### 10.3 技术栈详情
- Next.js 14.0+
- React 18.0+
- TypeScript 5.0+
- Tailwind CSS 3.0+
- Supabase 2.0+
- Recharts 2.0+
- D3.js 7.0+